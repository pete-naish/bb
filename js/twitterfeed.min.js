//JQuery Twitter Feed. Coded by Tom Elliott @ www.webdevdoor.com (2013) based on https://twitter.com/javascripts/blogger.js
//Requires JSON output from authenticating script: http://www.webdevdoor.com/php/authenticating-twitter-feed-timeline-oauth/
$(function(){function c(e){e=e.replace(/((https?|s?ftp|ssh)\:\/\/[^"\s\<\>]*[^.,;'">\:\s\<\>\)\]\!])/g,function(e){return'<a href="'+e+'"  target="_blank">'+e+"</a>"});e=e.replace(/\B@([_a-z0-9]+)/ig,function(e){return'<a href="http://twitter.com/'+e.substring(1)+'" target="_blank">'+e.charAt(0)+e.substring(1)+"</a>"});e=e.replace(/\B#([_a-z0-9]+)/ig,function(e){return'<a href="https://twitter.com/search?q='+e.substring(1)+'" target="_blank">'+e.charAt(0)+e.substring(1)+"</a>"});return e}function h(e){var t=e.split(" ");e=t[1]+" "+t[2]+", "+t[5]+" "+t[3];var n=Date.parse(e),r=arguments.length>1?arguments[1]:new Date,i=parseInt((r.getTime()-n)/1e3),s=e.substr(4,2)+" "+e.substr(0,3);i+=r.getTimezoneOffset()*60;return i<60?"1m":i<120?"1m":i<3600?parseInt(i/60).toString()+"m":i<7200?"1h":i<86400?parseInt(i/3600).toString()+"h":i<172800?s:s}var e=5,t="BeautyBox120",n="Beauty Box Knebworth",r=!1,i=!0,s=!0,o=!0,u=!0,a=!0,f="",l="";f+='<h1><a href="https://twitter.com/'+t+'" target="_blank">@'+t+"</a></h1>";l+='<div id="loading-container"><img src="../img/ajax-loader.gif" width="32" height="32" alt="tweet loader" /></div>';$(".feed-twitter").html(f+l);$.getJSON("../BeautyBox120-tweets.txt?"+Math.random(),function(t){var n="",o=1;for(var l=0;l<t.length;l++){var p=t[l].user.name,d=t[l].user.screen_name,v=t[l].user.profile_image_url_https,m=t[l].text,g=!1,y=!1,b=!1,w=t[l].id_str,E;if(typeof t[l].entities.media!="undefined"){E=t[l].entities.media[0].media_url;b=!0}if(typeof t[l].retweeted_status!="undefined"){v=t[l].retweeted_status.user.profile_image_url_https;p=t[l].retweeted_status.user.name;d=t[l].retweeted_status.user.screen_name;w=t[l].retweeted_status.id_str;m=t[l].retweeted_status.text;g=!0}t[l].text.substr(0,1)=="@"&&(y=!0);if((i==1||g==0&&i==0)&&(r==1||r==0&&y==0)&&t[l].text.length>1&&o<=e){s==1&&(m=c(m));o==1&&(n+=f);n+='<div class="status-article" id="tw'+o+'">';n+='<div class="feed-pic"><a href="https://twitter.com/'+d+'" target="_blank"><img src="'+v+'" width="42" height="42" alt="twitter icon" /></a></div>';n+='<div class="feed-text"><p><span class="tweetprofilelink"><a href="https://twitter.com/'+d+'" target="_blank">@'+d+'</a></span><span class="feed-time"><a href="https://twitter.com/'+d+"/status/"+w+'" target="_blank">'+h(t[l].created_at)+'</a></span><span class="feed-content">'+m+"</span></p>";b==1&&(n+='<div class="tweet-media-pic"><a href="https://twitter.com/'+d+"/status/"+w+'" target="_blank"><img src="'+E+'"/></a></div>');g==1&&a==1&&(n+='<div id="retweet-indicator"></div>');u==1&&(n+='<div id="twitter-actions"><div class="intent" id="intent-reply"><a href="https://twitter.com/intent/tweet?in_reply_to='+w+'" title="Reply"></a></div><div class="intent" id="intent-retweet"><a href="https://twitter.com/intent/retweet?tweet_id='+w+'" title="Retweet"></a></div><div class="intent" id="intent-fave"><a href="https://twitter.com/intent/favorite?tweet_id='+w+'" title="Favourite"></a></div></div>');n+="</div>";n+="</div>";o++}}$(".feed-twitter").html(n);u==1&&$("#twitter-actions a").click(function(){var e=$(this).attr("href");window.open(e,"tweet action window","width=580,height=500");return!1})}).error(function(e,t,n){var r="";e.status===0?r="Connection problem. Check file path and www vs non-www in getJSON request":e.status==404?r="Requested page not found. [404]":e.status==500?r="Internal Server Error [500].":exception==="parsererror"?r="Requested JSON parse failed.":exception==="timeout"?r="Time out error.":exception==="abort"?r="Ajax request aborted.":r="Uncaught Error.\n"+e.responseText;alert("error: "+r)})});